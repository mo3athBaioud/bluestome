var sendToBlogDialogDiv;function show_sendToBlogDialog(_1){if(!_ok_for_scrumjax_xml()){document.location="/blog.gne?photo="+_1;return;}var _2=_ge("photo_gne_button_blog_this");_2.EXT.disable_others();if(sendToBlogDialogDiv==undefined){make_send_to_div("sendToBlog",_1);}sendToBlogDialogDiv.style.left=(_find_x(_2)+0)+"px";sendToBlogDialogDiv.style.top=(_find_y(_2)+24)+"px";sendToBlogDialogDiv.style.display="block";if(navigator.userAgent.indexOf("Mozilla/5.0")!=-1&&navigator.userAgent.indexOf("KHTML")==-1){var _3=_ge("sendToBlogDialogListDiv").offsetHeight;if(_3>=220){_ge("sendToBlogDialogListDiv").style.overflow="-moz-scrollbars-vertical";}}}var sendToGroupDialogDiv;function show_sendToGroupDialog(_4){if(!_ok_for_scrumjax_xml()){document.location="/photo_sendto_group.gne?id="+_4;return;}var _5=_ge("photo_gne_button_send_to_group");_5.EXT.disable_others();if(sendToGroupDialogDiv==undefined){make_send_to_div("sendToGroup",_4);}sendToGroupDialogDiv.style.left=(_find_x(_5)+0)+"px";sendToGroupDialogDiv.style.top=(_find_y(_5)+24)+"px";sendToGroupDialogDiv.style.display="block";if(navigator.userAgent.indexOf("Mozilla/5.0")!=-1&&navigator.userAgent.indexOf("KHTML")==-1){var _6=_ge("sendToGroupDialogListDiv").offsetHeight;if(_6>=220){_ge("sendToGroupDialogListDiv").style.overflow="-moz-scrollbars-vertical";}}}var sendToSetDialogDiv;function show_sendToSetDialog(_7){if(!_ok_for_scrumjax_xml()){document.location="/photo_sendto_set.gne?id="+_7;return;}var _8=_ge("photo_gne_button_send_to_set");_8.EXT.disable_others();if(sendToSetDialogDiv==undefined){make_send_to_div("sendToSet",_7);}sendToSetDialogDiv.style.left=(_find_x(_8)+0)+"px";sendToSetDialogDiv.style.top=(_find_y(_8)+24)+"px";sendToSetDialogDiv.style.display="block";if(navigator.userAgent.indexOf("Mozilla/5.0")!=-1&&navigator.userAgent.indexOf("KHTML")==-1){var _9=_ge("sendToSetDialogListDiv").offsetHeight;if(_9>=220){_ge("sendToSetDialogListDiv").style.overflow="-moz-scrollbars-vertical";}}}var printDialogDiv;function show_printDialog(_10){if(!_ok_for_scrumjax_xml()){document.location="/photo_print.gne?id="+_10;return;}var _11=_ge("photo_gne_button_print");_11.EXT.disable_others();if(printDialogDiv==undefined){make_send_to_div("print",_10);}printDialogDiv.style.left=(_find_x(_11)+0)+"px";printDialogDiv.style.top=(_find_y(_11)+24)+"px";printDialogDiv.style.display="block";}function hide_printDialog(){hide_send_to_div(printDialogDiv,_ge("photo_gne_button_print"));var _12=_ge("print_form");if(_12&&_12.clear){_12.clear();}}function hide_sendToSetDialog(){hide_send_to_div(sendToSetDialogDiv,_ge("photo_gne_button_send_to_set"),_ge("sendToSetDialogFormDiv"));var _13=_ge("new_set_form");_13.set_title.value="";_13.set_description.value="";}function hide_sendToGroupDialog(){hide_send_to_div(sendToGroupDialogDiv,_ge("photo_gne_button_send_to_group"));}function hide_sendToBlogDialog(){hide_send_to_div(sendToBlogDialogDiv,_ge("photo_gne_button_blog_this"));}hide_send_to_div=function(div,_15,_16){_15.EXT.enable_others();_15.EXT.lock_down=0;_15.onmouseout();div.style.display="none";window.should_I_ignore_stuff_because_of_button_action=0;_ge(div.id.replace("Div","")+"HeaderDiv").innerHTML=div.get_click_a_text();var _17=_ge(div.id.replace("Div","")+"ListDiv");if(_16&&_16.style.display=="block"){_17.style.display="block";_16.style.display="none";}};make_send_to_div=function(_18,_19){var _20=_18+"Dialog";var _21=_20+"Div";if(_18=="sendToSet"){var _22="set";var _23=49;var _24="flickr.photosets.getList";var _25="You haven't created any<br>photo sets yet. You can<br><a href=\"\" onclick=\"_ge('"+_21+"').show_new_set_form();return false;\">create one now</a> if you like.";}else{if(_18=="sendToGroup"){var _22="group";var _23=54;var _24="flickr.groups.pools.getGroups";var _25="You don't belong to any<br>groups yet. You can find<br>and create groups <a href=\"/groups/\">here</a>.";}else{if(_18=="sendToBlog"){var _22="blog";var _23=48;var _24="flickr.blogs.getList";var _25="You haven't configured<br>a blog to post to yet.<br>Why not <a href=\"/blogs_add.gne?extra=photo"+_19+"\">do that now</a>?";}else{if(_18=="print"){var _22="print";var _23=58;var _24="";var _25="";}else{return;}}}}var div=window[_21]=document.createElement("div");div.id=_21;div.style.position="absolute";div.style.padding="0 0px 0px 0px";div.style.border="1px solid #999";div.style.borderWidth="0 1px 1px 1px";div.style.fontFamily="arial";div.style.fontSize="12px";div.style.textAlign="left";div.style.backgroundColor="#fff";div.style.width="250px";div.style.overflow="visible";if(_18=="print"){div.style.width="260px";var _26="<div style=\"border:1px solid #999; border-width:1px 0 0 0;height:1px; margin-left:"+_23+"px; font-size:1px;\"></div>";_26+="<div id=\""+_20+"HeaderDiv\" style=\"text-align:center; padding:3px 0 3px 0;\"><br>Loading print options...<br><br></div>";_26+="<div id=\""+_20+"ListWrapperDiv\" style=\"display:none; background-color:#fff; padding:4px 2px 4px 2px; border-bottom: 1px solid #ddd; border-top: 1px solid #ddd;\">";_26+="<div id=\""+_20+"ListDiv\" style=\"padding-right:2px; max-height:450px; overflow:auto;\"></div>";_26+="</div>";_26+="<div id=\""+_20+"BottomDiv\" style=\"margin:0px; display:none; background-color:#f7f7f7; font-family:arial; font-size:11px; padding:13px 13px 8px 13px;\">";_26+="<!--Flickr Printing services are provided by EZPrints. When you've finished collecting up the photos you want to print, click on the cart icon to finalize you order.";_26+="<br><img src=\"/images/cart.gif\" width=\"19\" height=\"16\" border=\"0\" style=\"border:0; float:right; display:block;\"><br clear=\"all\">";_26+="--></div>";}else{var _26="<div style=\"border:1px solid #999; border-width:1px 0 0 0;height:1px; margin-left:"+_23+"px; font-size:1px;\"></div>";_26+="<div id=\""+_20+"HeaderDiv\" style=\"text-align:center; padding:3px 0 3px 0;\"><br>loading "+_22+"s...<br><br></div>";_26+="<div style=\"display:none; background-color:#fff; padding:4px 2px 4px 2px; border-bottom: 1px solid #ddd; border-top: 1px solid #ddd;\">";_26+="<div id=\""+_20+"ListDiv\" style=\"padding-right:2px; max-height:220px; overflow:auto;\"></div>";_26+="\t<div id=\""+_20+"FormDiv\" style=\"margin:10px; display:none; height:200px\">";if(_18=="sendToSet"){_26+="<form id=\"new_set_form\" onsubmit=\"_ge('"+_21+"').create_new_set(); return false;\">";_26+="Title:<br><input type=\"text\" name=\"set_title\" style=\"width:220px;\"><br><br>";_26+="Description:<br><textarea type=\"text\" name=\"set_description\" style=\"width:220px; height:105px;\"></textarea><br>";_26+="<input type=\"button\" class=\"Butt\" value=\"CREATE NEW SET\" onclick=\"_ge('"+_21+"').create_new_set(); this.blur();\" style=\"margin:5px 0 0 0;\">";_26+="</form>";}_26+="</div>";_26+="</div>";_26+="<div id=\""+_20+"BottomDiv\" style=\"margin:3px; display:none; text-align:center;\">";_26+="<a href=\"\" onclick=\"hide_"+_20+"(); return false;\">Cancel</a>";_26+="</div>";}div.innerHTML=_26;document.body.appendChild(div);div.get_click_a_text=function(){var txt="";if(_18=="sendToSet"){txt+="Choose a set below";txt+=(_ok_for_scrumjax_xml()&&user_can_create_sets)?" (or <a href=\"\" onclick=\"_ge('"+_21+"').show_new_set_form();return false;\">create a new set</a>).":":";}else{if(_18=="print"){txt="Choose a print size &amp; quantity:";}else{txt="Choose a "+_22+" below:";}}return txt;};div.show_new_set_form=function(){_ge(_20+"ListDiv").parentNode.style.display="block";_ge(_20+"HeaderDiv").innerHTML="Create a new set:";_ge(_20+"ListDiv").style.display="none";_ge(_20+"FormDiv").style.display="block";_ge("new_set_form").set_title.focus();};div.create_new_set=function(){var _28=_ge("new_set_form");var _29=_28.set_title.value;var _30=_28.set_description.value;if(_29==""){alert("You must enter a title for the new set. Otherwise, what would it be titled?");return;}this.send_to_action(null,_29,"create",_30);};div.send_to_action=function(id,_32,_33,_34,_35){var _36=_ge("photo_notes");if(_18=="sendToGroup"&&_33=="add"&&!global_photos[_19].isPublic&&!_35){window["hide_"+_20]();var _37=function(){div.send_to_action(id,_32,_33,_34,1);};var _38="You are about to add a private photo to a group. This means that members of <b>"+_32+"</b> will be able to view, comment on, tag and add notes to this photo. Is this OK with you?";_36.EXT.start_comming(_38,1,1,"YES",_37,1,"NO",null);return;}deja_view_uh_huh();if(_18=="print"){var _39="Adding prints to cart...";}else{if(_33=="remove"){var _39="Removing photo from "+_22+"...";}else{if(_33=="create"){var _39="Creating new "+_22+"...";}else{var _39="Adding photo to "+_22+"...";}}}window["hide_"+_20]();this.id_dealing_with=id;this.title_dealing_with=_32;if(_18=="sendToSet"){if(_33=="create"){F.API.callMethod("flickr.photosets.create",{title:_32,description:_34,primary_photo_id:_19},div);}else{if(_33=="remove"){F.API.callMethod("flickr.photosets.removePhoto",{photoset_id:id,photo_id:_19},div);}else{F.API.callMethod("flickr.photosets.addPhoto",{photoset_id:id,photo_id:_19},div);}}}else{if(_18=="sendToGroup"){if(_33=="remove"){F.API.callMethod("flickr.groups.pools.remove",{group_id:id,photo_id:_19},div);}else{F.API.callMethod("flickr.groups.pools.add",{group_id:id,photo_id:_19},div);}}else{if(_18=="sendToBlog"){var _40=_ge("blog_form");_40.blog.value=id;_40.submit();return;}else{if(_18=="print"){div.addToCart_responses_expected=page_print_orderA.length;div.addToCart_responses=0;div.addToCart_error_count=0;div.addToCart_problem_product_ids=[];div.addToCart_cart_url="";div.addToCart_last_error="";div.send_another_printing_product();}else{return;}}}}if(_36&&_36.EXT){_36.EXT.start_comming(_39);}};div.send_another_printing_product=function(){var A=page_print_orderA[div.addToCart_responses].split(":");var _42={provider_id:page_printing_provider,photo_ids:_19,product_id:A[0].replace("prod",""),quantity:A[1]};F.API.callMethod("flickr.printing.addToCart",_42,div);};div.flickr_printing_addToCart_onLoad=function(_43,_44,_45,_46){div.addToCart_responses++;if(_43){div.addToCart_cart_url=_44.documentElement.getElementsByTagName("cart")[0].firstChild.nodeValue;}else{div.addToCart_error_count++;div.addToCart_problem_product_ids.push(_46.product_id);if(_45){div.addToCart_last_error=_45;}else{div.addToCart_last_error="unknown error";}}if(div.addToCart_responses!=div.addToCart_responses_expected){div.send_another_printing_product();return;}var _47=_ge("photo_notes");writeDebug("div.addToCart_responses "+div.addToCart_responses+" "+div.addToCart_error_count);if(div.addToCart_responses>div.addToCart_error_count){if(div.addToCart_error_count>0){var _48="We've added some prints of <b>"+global_photos[_19].title+"</b> to your cart"+", but there were errors adding "+div.addToCart_error_count+" of the prints. The last error was: "+"<b>"+div.addToCart_last_error.truncate_with_ellipses(400).replace("&","[wbr]&").replace("/","/[wbr]").replace("=","=[wbr]").escape_for_display_and_wrap().replace("[wbr]","<wbr>")+"</b><br><br>";}else{var _48="We've added these prints of <b>"+global_photos[_19].title+"</b> to <b><a href=\""+div.addToCart_cart_url+"\">your cart</a></b>:";}_48+="<ul style=\"padding-left:20px;\">";for(var i=0;i<page_print_orderA.length;i++){var A=page_print_orderA[i].split(":");if(_in_array(div.productsO[A[0]].id,div.addToCart_problem_product_ids)){_48+="<li style=\"color:red;\"><b>"+0+"</b> @ "+div.productsO[A[0]].id+" "+div.productsO[A[0]].name+"</li>";}else{_48+="<li><b>"+A[1]+"</b> @ "+div.productsO[A[0]].name+" <nobr>("+format_price(A[1]*(div.productsO[A[0]].price.replace(".","")))+")</nobr></li>";}}_48+="</ul>";_48+="<form id=\"print_cart_form\"><input type=\"button\" id=\"print_ok_button\" class=\"Butt\" value=\"CONTINUE BROWSING\" style=\"margin:5px 0 10px 0;\"><br>"+"Or are you ready to place your order?<br><input type=\"button\" id=\"print_cart_button\" class=\"Butt\" value=\"PROCEED TO CART\" style=\"margin:5px 0 10px 0;\"></form>"+"<div id=\"print_cart_prompt\"><img src=\"/images/cart.gif\" width=\"15\" height=\"12\" border=\"0\" style=\"margin:0 6px 20px 0; border:0; float:left; display:block;\">"+"<div>You can get to your cart anytime by clicking on the cart icon at the top of each page.</div></div>";_47.EXT.start_comming(_48,1,0,"GO TO CART",1,"CLOSE",null);var _50=_ge("print_ok_button");if(navigator.userAgent.indexOf("KHTML")==-1){_50.focus();}_50.onclick=function(){_47.EXT.stop_comming();this.blur();};var _51=_ge("print_cart_button");_51.onclick=function(){_47.EXT.stop_comming();this.blur();document.location=div.addToCart_cart_url;};}else{alert("There were errors adding the prints to your cart. The last error was: "+div.addToCart_last_error);if(_47&&_47.EXT){_47.EXT.stop_comming(1);}}};div.flickr_photosets_removePhoto_onLoad=div.flickr_groups_pools_remove_onLoad=function(_52,_53,_54){var _55=_ge("photo_notes");var _56=_ge("add_to_"+_22+"_"+this.id_dealing_with+"_div");var _57=_ge("add_to_"+_22+"_"+this.id_dealing_with+"_td");if(_52||_54.indexOf("not in pool")!=-1||_54.indexOf("not in set")!=-1){if(_56){_56.make_me_for_adding();}if(_55&&_55.EXT&&_18=="sendToSet"){var _58="This photo has been removed from your <b><a href=\""+global_photos[_19].ownersUrl+"sets/"+this.id_dealing_with+"/\">"+this.title_dealing_with+"</a></b> "+_22+"!";remove_context_widget("set",this.id_dealing_with);F.API.callMethod(_24,{},div);}else{if(_55&&_55.EXT&&_18=="sendToGroup"){var _58="This photo has been removed from the <b><a href=\"/groups/"+this.id_dealing_with+"/pool/\">"+this.title_dealing_with+"</a></b> "+_22+".";remove_context_widget("pool",this.id_dealing_with);}}_55.EXT.start_comming(_58,1,1,"OK");}else{alert("There was an error: "+_54);if(_55&&_55.EXT){_55.EXT.stop_comming(1);}}};div.flickr_photosets_addPhoto_onLoad=div.flickr_groups_pools_add_onLoad=function(_59,_60,_61,_62){var _63=_ge("photo_notes");var _64=_ge("add_to_"+_22+"_"+this.id_dealing_with+"_div");var _65=_ge("add_to_"+_22+"_"+this.id_dealing_with+"_td");if(_59||_61.indexOf("already in pool")!=-1||_61.indexOf("already in set")!=-1){if(_64){_64.make_me_for_removing();}if(_63&&_63.EXT&&_18=="sendToSet"){var _66="This photo has been added to your <b><a href=\""+global_photos[_19].ownersUrl+"sets/"+this.id_dealing_with+"/\">"+this.title_dealing_with+"</a></b> "+_22+".";add_context_widget("set",this.id_dealing_with,_19);}else{if(_63&&_63.EXT&&_18=="sendToGroup"){var _66="This photo has been added to the <b><a href=\"/groups/"+this.id_dealing_with+"/pool/\">"+this.title_dealing_with+"</a></b> "+_22+".";add_context_widget("pool",this.id_dealing_with,_19);}}var _67=function(){_64.confirm_remove();};_63.EXT.start_comming(_66,1,1,"OK",null,1,"UNDO",_67);}else{if(!_60){alert("There was an error: "+_61);if(_63&&_63.EXT){_63.EXT.stop_comming(1);}return;}var err=_60.documentElement.getElementsByTagName("err")[0];if(err&&err.getAttribute("code")=="5"&&_22=="group"){this.flickr_groups_getInfo_onLoad=function(_59,_60,_61,_62){var _69=_60.documentElement.getElementsByTagName("throttle")[0];var max=_69.getAttribute("count");var per=_69.getAttribute("mode");per=(per=="ever")?"":" per "+per;var s=(max*1>1)?"s":"";var _73="You can only add "+max+" photo"+s+per+" to "+this.title_dealing_with+". (You've already added "+max+". Remove a photo from the pool if you really want to add this one.)<br><br>See the <b><a href=\"/groups/"+this.id_dealing_with+"/\">"+this.title_dealing_with+"</a></b> "+_22+" page for more information.";_63.EXT.start_comming(_73,1,1);};F.API.callMethod("flickr.groups.getInfo",{group_id:this.id_dealing_with},this);}else{alert("There was an error: "+responseText);if(_63&&_63.EXT){_63.EXT.stop_comming(1);}}}};div.flickr_photosets_create_onLoad=function(_74,_75,_76){var _77=_ge("photo_notes");if(_74){var _78=_75.documentElement.getElementsByTagName("photoset")[0];if(_77&&_77.EXT&&_18=="sendToSet"){var _79="This photo has been added to a new set titled <b><a href=\""+_78.getAttribute("url")+"\">"+this.title_dealing_with+"</a></b>.";add_context_widget("set",_78.getAttribute("id"),_19);}_77.EXT.start_comming(_79,1,1,"OK",null);F.API.callMethod(_24,{new_set_id_passthrough:_78.getAttribute("id")},div);}else{alert("There was an error: "+_76);if(_77&&_77.EXT){_77.EXT.stop_comming(1);}}};div.flickr_photosets_getList_onLoad=div.flickr_blogs_getList_onLoad=div.flickr_groups_pools_getGroups_onLoad=function(_80,_81,_82,_83){if(!_80){alert("there was an error: "+_82);}if(_18=="sendToSet"){var _84=_81.documentElement.getElementsByTagName("photoset");user_can_create_sets=(_81.documentElement.getElementsByTagName("photosets")[0].getAttribute("cancreate")=="1")?1:0;_ge(_20+"HeaderDiv").innerHTML=this.get_click_a_text();}else{if(_18=="sendToGroup"){var _84=_81.documentElement.getElementsByTagName("group");}else{if(_18=="sendToBlog"){var _84=_81.documentElement.getElementsByTagName("blog");}else{return;}}}if(_84.length==0){if(_18=="sendToSet"){div.show_new_set_form();}else{_ge(_20+"BottomDiv").innerHTML="<br>"+_25+"<br><br>"+_ge(_20+"BottomDiv").innerHTML+"";_ge(_20+"HeaderDiv").style.display="none";}}else{_ge(_20+"ListDiv").innerHTML="";var si=_page_timer.add("before collection iteration");for(var g=0;g<_84.length;g++){_page_timer.add("before handle one");var _87=_84[g].getAttribute("id");if(_18=="sendToSet"){var _88="contextDiv_set"+_87;var _89="set";var _90=_81.documentElement.getElementsByTagName("title")[g].firstChild.nodeValue;var _91=_img_root+_84[g].getAttribute("server")+"/"+_84[g].getAttribute("primary")+"_"+_84[g].getAttribute("secret")+"_s.jpg";var _92=25;var _93=25;}else{if(_18=="sendToGroup"){var _88="contextDiv_pool"+_87;var _89="pool";var _90=_84[g].getAttribute("name");var _91=_img_root+_84[g].getAttribute("iconserver")+"/buddyicons/"+_84[g].getAttribute("id")+".jpg";var _92=24;var _93=24;}else{if(_18=="sendToBlog"){var _88="";var _89="";var _90=_84[g].getAttribute("name");var _91="/images/spaceball.gif";var _92=20;var _93=2;}}}var _94=(g==0||(document.all&&!window.opera))?"0px":"-2px";var _95=make_menu_item(_22,_87,_90,_94,_91,_93,_92,_20);_ge(_20+"ListDiv").appendChild(_95);if(_18!="sendToBlog"&&(_ge(_88)&&_ge(_88).style.display=="block"||nextprev_currentContextID==_89+_87)||_83.new_set_id_passthrough==_87){_95.make_me_for_removing();}else{_95.make_me_for_adding();}_page_timer.add("after handle one");}_page_timer.add("after collection iteration");_ge(_20+"ListDiv").parentNode.style.display="block";if(document.all&&!window.opera){_ge(_20+"ListDiv").style.height="auto";var osh=_ge(_20+"ListDiv").offsetHeight;if(osh&&osh>220){_ge(_20+"ListDiv").style.height="220px";}}_ge(_20+"HeaderDiv").innerHTML=div.get_click_a_text();}_ge(_20+"BottomDiv").style.display="block";_page_timer.dump(si);};div.flickr_printing_getProducts_onLoad=function(_97,_98,_99,_100){if(!_97){alert("there was an error: "+_99);}calculate_photo_props(_19);var p=global_photos[_19];var _102=_98.documentElement.getElementsByTagName("product");if(_102.length==0){hide_printDialog();return false;}else{window.page_print_prices={};div.productsO={};for(var g=0;g<_102.length;g++){var _103=_102[g].getAttribute("id");var _104=_102[g].getAttribute("price");var _105=_102[g].getAttribute("name");var _106=_102[g].getAttribute("description");var _107=_102[g].getAttribute("minresx")*1;var _108=_102[g].getAttribute("minresy")*1;var _109=_102[g].getAttribute("aspect")*1;var _110=_102[g].getAttribute("panorama")*1;var paul=0;if(p.huge){if(_in_array(_103,global_huge_photo_print_ids)){paul=1;}}else{if(_in_array(_103,global_wallet_photo_print_ids)){paul=1;}}if(p.square){if(_in_array(_103,global_square_photo_print_ids)){paul=1;}}if(p.dig_dims){if(_in_array(_103,global_dig_photo_print_ids)){paul=1;}}else{if(_in_array(_103,global_reg_photo_print_ids)){paul=1;}}writeDebug("min rec size:"+_107+"x"+_108+" size:"+p.w_o+"x"+p.h_o);if(_109==1){var _112=(Math.min(p.w_o,p.h_o)>=_107)?1:0;}else{var _112=(Math.max(p.w_o,p.h_o)>=Math.max(_107,_108)&&Math.min(p.w_o,p.h_o)>=Math.min(_107,_108))?1:0;}writeDebug("recommended:"+_112);div.productsO["prod"+_103]={id:_103,name:_105.replace("Digital Aspect",""),description:_106,price:_104,recommended:_112,show:paul,minresx:_107,minresy:_108};page_print_prices["prod"+_103]=_104.replace(".","");}}div.show_printing_products();};div.flickr_printing_setPrefs_onLoad=function(_113,_114,_115,_116){if(_113){F.API.callMethod("flickr.printing.getProviders",{country_code:page_printing_country_code},div);}else{alert("there was an error: "+_115);}};div.flickr_printing_getProviders_onLoad=function(_117,_118,_119,_120){if(_117){var _121=_118.documentElement.getElementsByTagName("provider");if(_121.length==0){page_printing_provider=0;}else{page_printing_provider=_121[0].getAttribute("id");}if(page_printing_provider==0){div.show_no_providers();}else{div.show_printing_products();}}else{alert("there was an error: "+_119);}};div.show_print_screen_changing=function(txt){_ge(_20+"HeaderDiv").innerHTML="<br>"+txt+"<br><br>";_ge(_20+"ListDiv").parentNode.style.display="none";};div.set_country_select=function(val){if(!val){val=0;}var _123=_ge("country");if(!_123){return;}for(var i=0;i<_123.options.length;i++){var o=_123.options[i];if(val==o.value){_123.selectedIndex=i;return;}}};div.show_no_providers=function(){_ge(_20+"HeaderDiv").innerHTML="We do apologize...";_ge(_20+"HeaderDiv").style.display="none";_ge(_20+"ListWrapperDiv").style.border="0px solid red";_ge("choose_a_country_div").style.display="none";if(div.no_providers_text==undefined){div.no_providers_text=_ge("no_providers_div").innerHTML;}var rep=function(txt){txt=txt.replace("REP_COUNTRY",page_printing_country_name);return txt;};_ge("no_providers_div").innerHTML=rep(div.no_providers_text);_ge("no_providers_div").style.display="block";_ge(_20+"ListDiv").parentNode.style.display="block";};div.show_country_form=function(){_ge(_20+"HeaderDiv").innerHTML="First things first!";_ge(_20+"HeaderDiv").style.display="none";_ge(_20+"ListWrapperDiv").style.border="0px solid red";_ge("no_providers_div").style.display="none";_ge("print_form").style.display="none";div.set_country_select(page_printing_country_code);var _126=_ge("country_submit");var _127=_ge("country_form");if(_127){_127.onsubmit=_126.onclick=function(){var i=_127.country.selectedIndex;if(_127.country.options[i].value==0){return false;}div.show_print_screen_changing("setting your country...");page_printing_country_code=_127.country.options[i].value;page_printing_country_name=_127.country.options[i].text;F.API.callMethod("flickr.printing.setPrefs",{country_code:page_printing_country_code},div);};var _128=_ge("country");_128.onchange=function(){if(navigator.userAgent.indexOf("KHTML")==-1){_126.focus();}};}_ge("choose_a_country_div").style.display="block";_ge(_20+"ListDiv").parentNode.style.display="block";if(_127){if(navigator.userAgent.indexOf("KHTML")==-1){_128.focus();}}};div.show_all_printing_products=function(){printDialogDiv.style.display="none";for(p in div.productsO){var prod=div.productsO[p];if(prod.show){continue;}_ge("prod_"+prod.id+"_tr").style.display=(document.all&&!window.opera)?"block":"table-row";if(!prod.recommended){_ge("print_not_rec_tr").style.display=(document.all&&!window.opera)?"block":"table-row";}}show_printDialog(_19);};div.show_printing_products=function(){if(div.productsO==undefined){F.API.callMethod("flickr.printing.getProducts",{provider_id:page_printing_provider},div);return;}_ge(_20+"HeaderDiv").innerHTML=div.get_click_a_text();_ge(_20+"HeaderDiv").style.display="block";_ge("choose_a_country_div").style.display="none";_ge("no_providers_div").style.display="none";var _130=_ge("print_product_tr");var _131=_130.parentNode;var rep=function(txt,prod){var _132=prod.description+" We recommend a minimum photo resolution of "+prod.minresx+" x "+prod.minresy+" pixels.";var _133=_get_tip_html(_132,"tip_print_menu");txt=txt.replace("REP_TIP",_133);txt=txt.replace("REP_NAME",prod.name);txt=txt.replace("REP_PRODUCT","prod"+prod.id);txt=txt.replace("REP_PRICE",prod.price);return txt;};for(p in div.productsO){var prod=div.productsO[p];var tr=document.createElement("tr");tr.id="prod_"+prod.id+"_tr";if(!prod.show){tr.style.display="none";}var td1=document.createElement("td");td1.className="print_dropdown_td";td1.innerHTML=rep(_130.childNodes[0].innerHTML,prod);tr.appendChild(td1);var td2=document.createElement("td");td2.className=(prod.recommended)?"print_item_td":"print_item_notrec_td";td2.innerHTML=rep(_130.childNodes[1].innerHTML,prod);tr.appendChild(td2);var td3=document.createElement("td");td3.className=(prod.recommended)?"print_price_td":"print_price_notrec_td";td3.innerHTML=rep(_130.childNodes[2].innerHTML,prod);tr.appendChild(td3);if(prod.recommended){_131.insertBefore(tr,_ge("print_not_rec_tr"));}else{if(prod.show){_ge("print_not_rec_tr").style.display=(document.all&&!window.opera)?"block":"table-row";}_131.appendChild(tr);}}var _138=_ge("print_cancel");var _139=_ge("print_add");var _140=_ge("print_form");_140.clear=function(){for(var i=0;i<_140.elements.length;i++){if(_140.elements[i].type=="select-one"){_140.elements[i].selectedIndex=0;}}update_print_prices();};page_print_orderA=[];_138.onclick=hide_printDialog;_139.onclick=function(){page_print_orderA=[];for(var i=0;i<_140.elements.length;i++){if(_140.elements[i].type=="select-one"){if(_140.elements[i].value*1>0){writeDebug("print_form.elements[i].value "+_140.elements[i].value);page_print_orderA.push(_140.elements[i].name+":"+_140.elements[i].value);}}}if(page_print_orderA.length>0){div.send_to_action(_19,"cart","add");}return false;};if(_ge("change_country_link2")){_ge("change_country_link2").onclick=function(){div.show_country_form();return false;};}if(_ge("more_print_options")){_ge("more_print_options").onclick=function(){this.style.display="none";div.show_all_printing_products();return false;};}_ge("print_form").style.display="block";_ge(_20+"ListDiv").parentNode.style.display="block";};div.print_fragment_onLoad=function(_141,_142,_143){_ge(_20+"ListDiv").innerHTML=_142;if(page_printing_provider){div.show_printing_products();}else{if(page_printing_country_code!=""){div.show_no_providers();}else{div.show_country_form();}}};if(_18=="print"){var _144={photo_id:_19};if(page_zazzle_url!=undefined){_144["zazzle_url"]=page_zazzle_url;}F.fragment_getter.get("/photo_print_fragment.gne",_144,div,"print_fragment_onLoad");}else{F.API.callMethod(_24,{},div);}};make_menu_item=function(what,_146,_147,_148,_149,_150,_151,_152){var _153=(document.all&&!window.opera)?217:220;var _154=document.createElement("DIV");_154.id="add_to_"+what+"_"+_146+"_div";_154.style.marginTop=_148;_154.highlight=function(){this.style.backgroundColor="#0063DC";_ge("add_to_"+what+"_"+_146+"_td").style.color="#fff";};_154.unhighlight=function(){this.style.backgroundColor="transparent";_ge("add_to_"+what+"_"+_146+"_td").style.color="#0063DC";};_154.add_action=function(){window[_152+"Div"].send_to_action(_146,_147,"add");};_154.remove_action=function(){window[_152+"Div"].send_to_action(_146,_147,"remove");};_154.confirm_remove=function(){window["hide_"+_152]();var _155=function(){_154.remove_action();};var _156=_ge("photo_notes");_156.EXT.start_comming("Are you sure you want to remove this photo from <b>"+_147+"</b>?",1,1,"YES",_155,1,"CANCEL",null);};_154.make_me_for_removing=function(){this.unhighlight();this.style.cursor="default";_ge("add_to_"+what+"_"+_146+"_td").style.color="#999";if(what=="set"){remove_link="<a title=\"Remove this photo from your "+_147.replace("<","&lt;").replace("\"","&quot;")+" set\" class=\"remove_thing\" href=\"\" onclick=\"_ge('"+_154.id+"').confirm_remove();return false;\">[X]</a>";}else{if(what=="group"){remove_link="<a title=\"Remove this photo from the "+_147.replace("<","&lt;").replace("\"","&quot;")+" pool\" class=\"remove_thing\" href=\"\" onclick=\"_ge('"+_154.id+"').confirm_remove();return false;\">[X]</a>";}}_ge("add_to_"+what+"_"+_146+"_td").innerHTML=_147.truncate_with_ellipses(25)+" "+remove_link;this.onmouseout=null;this.onmouseover=null;this.onclick=null;};_154.make_me_for_adding=function(){this.unhighlight();this.style.cursor=(document.all&&!window.opera)?"hand":"pointer";_ge("add_to_"+what+"_"+_146+"_td").style.color="#0063DC";_ge("add_to_"+what+"_"+_146+"_td").innerHTML="<span>"+_147.truncate_with_ellipses(31)+"</span>";this.onmouseout=this.unhighlight;this.onmouseover=this.highlight;this.onclick=this.add_action;};var html="";html+="<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\""+_153+"\"><tr>";html+="<td valign=\"top\" style=\"padding:0; width:"+(_150+7)+"px;\">";html+="<img src=\""+_149+"\" width=\""+_150+"\" height=\""+_151+"\" style=\"border:0; display:block; margin: 2px 0 2px 2px;\"></td>";html+="<td id=\"add_to_"+what+"_"+_146+"_td\">";html+="</td></tr></table>";_154.innerHTML=html;return _154;};remove_context_widget=function(_158,_159){var _160=_ge("contextDiv_"+_158+_159);if(_160){_160.style.display="none";if(nextprev_currentContextID==_158+_159){var _161=_ge("nextprev_button_stream"+global_nsid);if(_161&&!_161.EXT.isOpen){_161.onmouseup();_161.onmouseout();}}var _162=_ge("other_contexts_p");var _163=document.getElementsByClass("contextDiv","DIV");var c=0;for(var i=0;i<_163.length;i++){if(_163[i].style.display=="block"&&_163[i].parentNode==_162.parentNode){c++;break;}}if(!c){_162.style.display="none";}}};add_context_widget=function(_165,_166,_167){var _168=_ge("contextDiv_"+_165+_166);var _169=_ge("other_contexts_p");_169.style.display="block";if(_168){_168.style.display="block";if(nextprev_currentContextID==_165+_166){var _170=_ge("nextprev_button_stream"+global_nsid);if(_170&&_170.EXT.isOpen){_170.onmouseup();_170.onmouseout();}}}else{_169.add_context_widget=function(_171,_172,_173){if(_172==""){return;}var temp=document.createElement("div");temp.id="contextDiv_"+_165+_166;temp.style.display="block";temp.innerHTML=_172;var _175=this.parentNode.getElementsByTagName("DIV");if(_175.length>0){this.parentNode.insertBefore(temp,_175[0]);}else{this.parentNode.appendChild(temp);}_decorate(_ge("nextprev_button_"+_165+_166),_165,_166,_167);};F.fragment_getter.get("/photo_context_fragment.gne",{photo_id:_167,context_type:_165,context_id:_166},_169,"add_context_widget");}};increment_print_dropdown=function(_176){var w=_ge(_176);var si=w.selectedIndex;si++;if(si>=w.options.length){for(var i=0;i<10;i++){w.options.length++;w.options[w.options.length-1].value=w.options[w.options.length-1].text=w.options.length-1;}}w.selectedIndex=si;update_print_prices(_176);};decrement_print_dropdown=function(_178){var w=_ge(_178);var si=w.selectedIndex;si--;if(si<0){return;}w.selectedIndex=si;update_print_prices(_178);};format_price=function(p){var dp=p/100;if(dp==0){dp="0.00";}else{if(dp<1){dp=dp.toString();}}dpA=dp.toString().split(".");if(dpA.length==1){dp=dp.toString()+".00";}else{if(dpA[1].length==1){dp=dp.toString()+"0";}}dp="$ "+dp;return dp;};update_print_prices=function(_180){var _181=_ge("print_form");var _182=_ge("price_print_total_td");var t=0;for(var i=0;i<_181.elements.length;i++){if(_181.elements[i].type=="select-one"){if(_181.elements[i].value*1>0){var p=page_print_prices[_181.elements[i].name];t=t+(p*_181.elements[i].value);}}}var ft=format_price(t);if(t>0){ft="<nobr><b>"+ft+"</b></nobr>";if(_181.last_total!=t){anim_do_blink_pink(_182);}}else{_182.style.color="rgb(0, 0, 0)";}_182.innerHTML=ft;_181.last_total=t;};var place_notes_text_div=function(t){if(!document.all||window.opera){return;}var _185=_ge("photo_notes");if(_185){_185.EXT.place_notes_text_div();_set_single_shadow_height(_185.EXT.notes_text_table);}return;};var adjust_textarea_height=function(t){return;temp_div.innerHTML=t.value.replace("<","&lt;").replace("\n","<br>")+"g";t.style.height=(temp_div.offsetHeight)+"px";return;if(t.scrollHeight>t.clientHeight){t.style.height=t.scrollHeight;}};function show_notes_initially(){if(window.should_I_ignore_stuff_because_of_button_action||window.should_I_ignore_stuff_because_of_editable_div_action){return;}var _186=_ge("photo_notes");if(_186&&_186.EXT){_186.EXT.shown_initially=1;_186.style.visibility="visible";if(!_186.EXT.tried_to_show_before_shown_initially){_186.EXT.go_away_in_a_bit();}}}function calculate_photo_props(_187){var p=global_photos[_187];if(!p){return;}var _188=Math.max(p.w_o,p.h_o);var _189=Math.min(p.w_o,p.h_o);p.aspect=_188/_189;p.panorama=(p.aspect>=2)?1:0;p.dig_dims=(p.aspect<1.36)?1:0;p.square=(p.aspect>0.96&&p.aspect<1.04)?1:0;p.small=(_188<=1024)?1:0;p.huge=(_189>=3000&&_188>=4500)?1:0;if(writeDebug){writeDebug("aspect "+p.aspect);}if(writeDebug){writeDebug("panorama "+p.panorama);}if(writeDebug){writeDebug("dig_dims "+p.dig_dims);}if(writeDebug){writeDebug("square "+p.square);}if(writeDebug){writeDebug("small "+p.small);}if(writeDebug){writeDebug("huge "+p.huge);}}
